### 1.6 PHP基础知识 -- 正则表达式
***

#### 正则表达式

**作用 ：**

> 分割、查找、匹配、替换字符串。

**分隔符：**

> 正斜线（/）
> 
> hash符号（#）
> 
> 取反符号（~）

**通用原子：**

> \d // 十进制0-9
> 
> \D // 取反，除了十进制的0-9
> 
> \w // 数字、字母、下划线
> 
> \W // 除了数字、字母、下划线
> 
> \s // 空白符
> 
> \S // 除了空白符

**元字符：**
> . // 可代表除了换行符外的任意字符
> 
> \* // 匹配任意次
> 
> ? // 匹配0次或1次
> 
> \+ // 匹配1次或多次
> 
> ^ // 匹配字符串开始的位置
> 
> $ // 匹配字符串结尾的位置
> 
> {n} // 匹配n个
> 
> {n,} // 匹配至少n个
> 
> {n,m} // 匹配n到m个
> 
> [] // 匹配方括号内的任意元素
> 
> () // 后向引用
> 
> [^] // 匹配除了方括号内的元素
> 
> | // 或
> 
> [-] // 区间，例如[0-9]，即匹配0到9

**模式修正符：**

> i
> 
> m
> 
> e 
> 
> s
> 
> U // 懒惰模式
> 
> x
> 
> A
> 
> D
> 
> u

**后向引用：**

> 通过英文括号标识的部分，在表达式后面部分引用，每个括号代表一处后向引用，最多不超过9处，通过\1至\9来引用
```php
$str = '<b>abc</b>';
$pattern = '/<b>(.*)<\/b>/';
$res  = preg_replace($pattern, '\\1', $str); // 这里的\1代表的就是$pattern中括号括起来部分匹配到的字符串，通过\1的形式可以识别并在正则表达式或其它地方引用。
echo $res; // 这里会输出abc，即\1代表的(.*)部分
```

**贪婪模式：**

> 匹配出现歧义时取最长（默认模式）

**懒惰模式：**

> 匹配出现歧义时取最短

```php
$str = '<b>abc</b><b>efg</b>';

//贪婪模式
$pattern1 = '/<b>(.*)<\/b>/';
$res = preg_replace($pattern1, '\\1', $str);
echo $res; // 匹配最长符合的字符串，即(.*)代表的是'abc</b><b>efg'

//懒惰模式
$pattern2 = '<b>(.*)<\/b>/U'; //结尾加U
$res2 = preg_replace($pattern2, '\\1', $str);
echo res2; // 匹配最短符合的字符串，即(.*)代表的是'abc'
```

#### 中文匹配

**UTF-8：**
> 1. UTF-8汉字编码范围是0x4e00-0x9fa5
> 
> 2. 要使用`u模式修正符`使模式字符串被当成UTF-8


**ANSI(gb2312)：**
> 1. ANSI(gb2312)环境下，范围是0xb0-0xf7，0xa1-0xfe
> 
> 2. 要使用char将Ascii码转换为字符

```php
$str = '中文字符串';
// UTF-8
$pattern1 = '/[\x{4e00}-\x{9fa5}]+/u'; // \x代表16进制，u转为UTF-8
// ANSI(gb2312)
$pattern2 = '/[' . chr(0xb0) . '-' . chr(0xf7) . ']+|[' . chr(0xa1) . '-' . chr(0xfe) . ']+/';
 
$res1 = preg_match($pattern1, $str);
echo $res1 . "\n"; // 1
$res2 = preg_match($pattern2, $str);
echo $res2 . "\n"; // 1
```


#### 常用函数

> preg_match()
> 
> preg_match_all()
> 
> preg_replace()
> 
> preg_split()

#### 正则表达式解决思路
> 1. 先写出一个需匹配的字符串。
> 2. 自左向右按顺序使用正则表达式的原子和元字符进行拼接。
> 3. 最终加入模式修正符。
> 4. 切勿死记硬背，但是要练习常用的正则表达式（手机号、url、邮箱、IP地址等）。


***
真题1：至少写出一种验证139开头的11位手机号码的正则表达式。
```php
$pattern = '/^139[0-9]{8}$/'
```

真题2：请写出一个正则表达式，取出页面中所有img标签中的src值
```php
$pattern = '/<img.*src=([\'\'\', \'\"\']){1}(.*)\1.*>$/';
```

[**下一小节：1.7 文件及目录处理**](https://github.com/201502lisihao/PHP-Technology-Stack-Review/blob/master/1-PHP%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/1-7%E6%96%87%E4%BB%B6%E5%8F%8A%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C.md)