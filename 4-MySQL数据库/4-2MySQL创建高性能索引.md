## 4.2 MySQL数据库 -- 创建高性能索引
***

### MySQL索引的基础和类型

> 索引类似于书籍的目录，想要找到一本书的某个特定主题，需要先查找书籍的目录，定位对应的页码。
> 
> 存储引擎使用类似的方式进行数据查询，先去索引中找到对应的值，然后根据匹配的索引找到对应的数据行。

**索引对性能的影响：**

> 1. 大大减少服务器需要扫描的数据量，提高查询速度
> 2. 帮助服务器避免排序和临时表
> 3. 将随机I/O变成顺序I/O
> 4. 降低写的速度，占用磁盘空间

**索引的使用场景：**

> 对于非常小的表，大部分情况下全表扫描更快
> 
> 对于中型到大型的表，索引非常有效
> 
> 对于特大型的表，建立和使用索引的代价将随之增大，可以采用分区技术来解决

**索引类型：**

```
普通索引：最基本的索引，没有任何约束
唯一索引：与普通索引类似，但是具有唯一性约束
主键索引：特殊的唯一索引，不允许有空值，只能有一个
组合索引：将多个列组合在一起创建索引，覆盖多个列
外键索引：只有InnoDB的表可以使用外键索引，保证数据的一致性、完整性和实现级联操作
全文索引：只有MyISAM的表可以使用全文索引，并且只能对英文进行全文检索

//主键和唯一索引的区别
//1.一个表只能由一个主键索引，可以有多个唯一索引
//2.主键索引一定是唯一索引，唯一索引不一定是主键索引
//3.主键可以和外键构成完整性约束，防止数据不一致
```


### MySQL索引的创建原则

> 1. 最适合建立索引的点是where语句中的列，或者连接字句中的列，而不是select关键字后的列。
> 2. 索引列的基数越大，索引的效果越好。
> 3. 对于字符串索引，应指定一个前缀长度，可以节省大量空间。
> 4. 根据情况创建组合索引，可以提高查询效率。
> 5. 避免创建过多的索引，一般不超过5个。
> 6. 主键应尽可能选择较短的数据类型，可以有效的减少索引的磁盘占用，提供查询效率。

### MySQL索引的注意事项

> 1. 组合索引遵循`最左前缀匹配原则`，mysql会一直向右匹配直到遇到范围查询(>、<、between、like)就停止匹配，比如a=1 and b=2 and c>3 and d=4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。
> 2. like查询，%不能在前，实在需要这样查，可以使用其它全文检索引擎（ElasticSearch等）。
> 3. 尽量扩展索引，不要新建索引。
> 4. 如果我们查询一个列是否是null，也是可以用到索引的。
> 5. 如果MySQL估计使用索引比全表扫描更慢，会放弃使用索引。
> 6. 如果or前的列有索引，但是后面的没有，那么前面的索引也不会被用到。
> 7. 列类型是字符串类型，查询时一定要给值加上引号，不然索引会失效 。
> 8.  索引列不能参与计算，否则不能使用到索引。
> 9. 数据库多表联查时，左连接保证右表字段索引，右连接保证左表字段索引，内连接保证任一表连接字段索引。

***
真题1：请简单描述MySQL中，索引、主键、唯一索引，和联合索引的区别，以及索引对数据库的性能有什么样的影响？

> 请思考后写出答案。

[**下一小节：4.3 SQL语句编写**](https://github.com/201502lisihao/PHP-Technology-Stack-Review/blob/master/4-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/4-3SQL%E8%AF%AD%E5%8F%A5%E7%BC%96%E5%86%99.md)